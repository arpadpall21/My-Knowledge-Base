<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title> Tokens </title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
    integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="../../Assets/stylesPages.css">
  <script src="../../Assets/scriptPages.js"></script>
</head>

<body>
  <h1> Tokens </h1>
  <p> Updated ( 2023-02-13 )</p>
  <p class="sitenav"> <a href="../../index.html" title="home">MySite></a>
    <a href="../index.html">HTTP & REST Api></a> Tokens
  </p>
  <br>
  <details class="example" id="notes">
    <summary> Notes :</summary>
    <!-- <p> - paragraph removes the 'empty' message from the detail TAG -->
  </details>
  <h2 style="color:green;"><u> Useful Links : </u></h2>

  <h2 style="color:green;"><u> Remember This : </u></h2>

  <h2 style="color:green;"><u> Description and Demonstration : </u></h2>
  <h2 class="header"> Basic Authentication </h2>
  <p> - sessions are used to identify different clients, for this we use session tokens </p>
  <p> - session tokens are generated by the server and issued through cookies to the client </p>
  <p> - step 1: client logs in with password </p>
  <p> - step 2: server identifies the client then issues a session token through cookies </p>
  <p> - step 3: after this the client only sends its token, so the server verifies the identity of the client through
    the session token (no need to login again, server can control for how long the client is logged in, etc..)</p>
  <!------------------------------------------------------------------------------------------------>
  <hr>
  <h2 class="header"> JWT Token </h2>
  <p> - a JWT (JSON Web Token) is basically an advanced session token, it has serveral advantages over a normal session
    token </p>
  <p> - JWT Tokens contain the client's identification data, encoded with the server's private key, signed with a
    hashing algorithm and <u>not stored by the server (this way multiple servers (having the same key) can identify the
      same client)</u></p>
  <p> - JWT Tokens contain timing data so we can configure their expiration, the expiration can be checked on token
    verifyication (ex: <mark>jwt.verify()</mark>) </p>
  <p> - JWT is composed of 3 parts: </p>
  <p style="text-indent:30px"> Hearder: contains basic info (hashing algorithm, etc...) </p>
  <p style="text-indent:30px"> Body: contains the client's Id, expiration, etc... </p>
  <p style="text-indent:30px"> Signature: header + body encoded with the secret key </p>
  <p> - the client sends its JWT token in the <mark>Authorization: Bearer <strong>jswToken</strong></mark> header </p>
  <!------------------------------------------------------------------------------------------------>
  <hr>
  <h2 class="header"> OAuth 2.0 & Open Id Connect</h2>
  <h3 class="header"> OAuth 2.0 </h3>
  <p> - the OAuth 2.0 (Open Authorization) is an <u>Authorization</u> protocol, the user can delegate some authorization
    for us, this means we can do certain stuff in hehalf of him (on the 3rd party app) </p>
  <p> - OAuth 2.0 is an Authorization protocol meaning that we can do certain stuff in the behalf of the user <u>but we
      don't know anyting about the user's credentials </u>
  <p> - OAuth 2.0 terminology: </p>
  <p style="text-indent: 30px;"> - Resource Onwer: the user owning resources on a 3rt party app </p>
  <p style="text-indent: 30px;"> - Authorization Server: the 3rt party server that deals with all authorizations </p>
  <p style="text-indent: 30px;"> - Resource Server: the 3rt party server that manages the resource owner's resources
  </p>
  <p style="text-indent: 30px;"> - Authorization Grant: the authorization code that we can exchange for an Access &
    Refresh token </p>
  <p style="text-indent: 30px;"> - Redirect URI: URL where we want to recevies the Authorization Code or Access Tokens
    from the 3rd party app </p>
  <p style="text-indent: 30px;"> - Authorization Scope: limited authorization categories (scopes) defined by the 3rd
    party app </p>
  <p style="text-indent: 30px;"> - Response Type: the OAuth type we whant to receive (<mark>code</mark> = Authorization
    Code / <mark>token</mark> = Access Token) </p>
  <img src="OAuth flow.png" width="800">
  <h3 class="header"> Open Id Connect </h3>
  <p> - Open Id Connect is an Authentication protocol, it's basically an extension of OAuth 2.0 </p>
  <p> - when when sending the redirect URI request we specify <mark>openid</mark> as scope (is that simple) </p>
  <p> - when exchanging the Authorization code for an Access token we also get an Id token (JWT token containing the
    user's id) </p>
  <!------------------------------------------------------------------------------------------------>
  <hr>
  <h2 class="header"> CSRF </h2>
  <p> - CSRF (Cross Site Request Forgery) tokens protect us againts cross site attacks (attacker making requests in
    the victim's behalf) </p>
  <p> 1) the server generates a unique CSRF token and sends it to the client </p>
  <p> 2) the client includes the CSRF token as a form field in all form requests </p>
  <p> 3) the server receives the CSRF token in the form and compares with the session Id (or does some other security
    check with it) in order to make sure tha the form request is legit </p>
  <p> - the security provided by the CSRF token is that the attacker cannot get the CSRF token from the form request </p>
  <!------------------------------------------------------------------------------------------------>
  <hr>
  <h2 class="headerExtra"> Access Token & Refresh Token (simple demo on github repo
    <mark>arpadpall21/jwt_token_demo</mark>)
  </h2>
  <p> - the Access Token is usually a short lived token (5 - 30 minutes), it is used to access the resource server after
    logged in </p>
  <p> - the Refresh Token is kept by the Authentication Server, it is used to issue a new Access Token or can be used to
    forcefully revoke Client Authentication </p>
  <p> - talking to the Authentication server happens on the <b>back channel (highly sercure)</b>, talking to the
    Resoruce Server happens on the <b>front channel (less sercure)</b> </p>
  <img src="Tokens.png" width="800">
  <br><br>
</body>

</html>